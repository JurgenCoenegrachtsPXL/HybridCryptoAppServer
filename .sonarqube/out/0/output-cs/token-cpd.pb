›#
iC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\HybridCryptoAppContext.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
{ 
public 

class "
HybridCryptoAppContext '
:( )
IdentityDbContext* ;
<; <
User< @
,@ A
RoleB F
,F G
intH K
>K L
{ 
public		 
DbSet		 
<		 
UserContact		  
>		  !
UserContacts		" .
{		/ 0
get		1 4
;		4 5
set		6 9
;		9 :
}		; <
public

 
DbSet

 
<

 
EncryptedPacket

 $
>

$ %
EncryptedPackets

& 6
{

7 8
get

9 <
;

< =
set

> A
;

A B
}

C D
public "
HybridCryptoAppContext %
(% &
)& '
{ 	
} 	
public "
HybridCryptoAppContext %
(% &
DbContextOptions& 6
<6 7"
HybridCryptoAppContext7 M
>M N
optionsO V
)V W
:X Y
baseZ ^
(^ _
options_ f
)f g
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
Entity 
<  
UserContact  +
>+ ,
(, -
)- .
.. /
HasKey/ 5
(5 6
u6 7
=>8 :
new; >
{? @
uA B
.B C
OwnerIdC J
,J K
uL M
.M N
	ContactIdN W
}W X
)X Y
;Y Z
modelBuilder 
. 
Entity 
<  
UserContact  +
>+ ,
(, -
)- .
.. /
HasOne/ 5
(5 6
u6 7
=>8 :
u; <
.< =
Contact= D
)D E
;E F
modelBuilder 
. 
Entity 
<  
UserContact  +
>+ ,
(, -
)- .
.. /
HasOne/ 5
(5 6
u6 7
=>8 :
u; <
.< =
Owner= B
)B C
;C D
modelBuilder 
. 
Entity 
<  
User  $
>$ %
(% &
)& '
.' (
HasMany( /
(/ 0
u0 1
=>2 4
u5 6
.6 7
ContactList7 B
)B C
.C D
WithOneD K
(K L
uL M
=>N P
uQ R
.R S
OwnerS X
)X Y
.Y Z
OnDeleteZ b
(b c
DeleteBehaviorc q
.q r
Restrictr z
)z {
;{ |
modelBuilder 
. 
Entity 
<  
EncryptedPacket  /
>/ 0
(0 1
)1 2
.2 3
HasOne3 9
(9 :
e: ;
=>< >
e? @
.@ A
SenderA G
)G H
.H I
WithManyI Q
(Q R
)R S
.S T
OnDeleteT \
(\ ]
DeleteBehavior] k
.k l
Restrictl t
)t u
;u v
modelBuilder 
. 
Entity 
<  
EncryptedPacket  /
>/ 0
(0 1
)1 2
.2 3
HasOne3 9
(9 :
e: ;
=>< >
e? @
.@ A
ReceiverA I
)I J
.J K
WithManyK S
(S T
)T U
.U V
OnDeleteV ^
(^ _
DeleteBehavior_ m
.m n
Restrictn v
)v w
;w x
}   	
public"" 
void"" "
CreateOrUpdateDatabase"" *
(""* +
)""+ ,
{## 	
Database$$ 
.$$ 
Migrate$$ 
($$ 
)$$ 
;$$ 
}%% 	
}&& 
}'' √É
tC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Migrations\20200423180027_initial.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &

Migrations& 0
{ 
public 

partial 
class 
initial  
:! "
	Migration# ,
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
nullable+ 3
:3 4
false5 :
): ;
. 

Annotation #
(# $
$str$ C
,C D(
MySqlValueGenerationStrategyE a
.a b
IdentityColumnb p
)p q
,q r
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
	maxLength0 9
:9 :
$num; >
,> ?
nullable@ H
:H I
trueJ N
)N O
,O P
NormalizedName "
=# $
table% *
.* +
Column+ 1
<1 2
string2 8
>8 9
(9 :
	maxLength: C
:C D
$numE H
,H I
nullableJ R
:R S
trueT X
)X Y
,Y Z
ConcurrencyStamp $
=% &
table' ,
., -
Column- 3
<3 4
string4 :
>: ;
(; <
nullable< D
:D E
trueF J
)J K
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 5
,5 6
x7 8
=>9 ;
x< =
.= >
Id> @
)@ A
;A B
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
nullable+ 3
:3 4
false5 :
): ;
. 

Annotation #
(# $
$str$ C
,C D(
MySqlValueGenerationStrategyE a
.a b
IdentityColumnb p
)p q
,q r
UserName   
=   
table   $
.  $ %
Column  % +
<  + ,
string  , 2
>  2 3
(  3 4
	maxLength  4 =
:  = >
$num  ? B
,  B C
nullable  D L
:  L M
true  N R
)  R S
,  S T
NormalizedUserName!! &
=!!' (
table!!) .
.!!. /
Column!!/ 5
<!!5 6
string!!6 <
>!!< =
(!!= >
	maxLength!!> G
:!!G H
$num!!I L
,!!L M
nullable!!N V
:!!V W
true!!X \
)!!\ ]
,!!] ^
Email"" 
="" 
table"" !
.""! "
Column""" (
<""( )
string"") /
>""/ 0
(""0 1
	maxLength""1 :
:"": ;
$num""< ?
,""? @
nullable""A I
:""I J
true""K O
)""O P
,""P Q
NormalizedEmail## #
=##$ %
table##& +
.##+ ,
Column##, 2
<##2 3
string##3 9
>##9 :
(##: ;
	maxLength##; D
:##D E
$num##F I
,##I J
nullable##K S
:##S T
true##U Y
)##Y Z
,##Z [
EmailConfirmed$$ "
=$$# $
table$$% *
.$$* +
Column$$+ 1
<$$1 2
bool$$2 6
>$$6 7
($$7 8
nullable$$8 @
:$$@ A
false$$B G
)$$G H
,$$H I
PasswordHash%%  
=%%! "
table%%# (
.%%( )
Column%%) /
<%%/ 0
string%%0 6
>%%6 7
(%%7 8
nullable%%8 @
:%%@ A
true%%B F
)%%F G
,%%G H
SecurityStamp&& !
=&&" #
table&&$ )
.&&) *
Column&&* 0
<&&0 1
string&&1 7
>&&7 8
(&&8 9
nullable&&9 A
:&&A B
true&&C G
)&&G H
,&&H I
ConcurrencyStamp'' $
=''% &
table''' ,
.'', -
Column''- 3
<''3 4
string''4 :
>'': ;
(''; <
nullable''< D
:''D E
true''F J
)''J K
,''K L
PhoneNumber(( 
=((  !
table((" '
.((' (
Column((( .
<((. /
string((/ 5
>((5 6
(((6 7
nullable((7 ?
:((? @
true((A E
)((E F
,((F G 
PhoneNumberConfirmed)) (
=))) *
table))+ 0
.))0 1
Column))1 7
<))7 8
bool))8 <
>))< =
())= >
nullable))> F
:))F G
false))H M
)))M N
,))N O
TwoFactorEnabled** $
=**% &
table**' ,
.**, -
Column**- 3
<**3 4
bool**4 8
>**8 9
(**9 :
nullable**: B
:**B C
false**D I
)**I J
,**J K

LockoutEnd++ 
=++  
table++! &
.++& '
Column++' -
<++- .
DateTimeOffset++. <
>++< =
(++= >
nullable++> F
:++F G
true++H L
)++L M
,++M N
LockoutEnabled,, "
=,,# $
table,,% *
.,,* +
Column,,+ 1
<,,1 2
bool,,2 6
>,,6 7
(,,7 8
nullable,,8 @
:,,@ A
false,,B G
),,G H
,,,H I
AccessFailedCount-- %
=--& '
table--( -
.--- .
Column--. 4
<--4 5
int--5 8
>--8 9
(--9 :
nullable--: B
:--B C
false--D I
)--I J
,--J K
PublicKeyXml..  
=..! "
table..# (
...( )
Column..) /
<../ 0
string..0 6
>..6 7
(..7 8
nullable..8 @
:..@ A
true..B F
)..F G
,..G H
	FirstName// 
=// 
table//  %
.//% &
Column//& ,
<//, -
string//- 3
>//3 4
(//4 5
nullable//5 =
://= >
true//? C
)//C D
,//D E
LastName00 
=00 
table00 $
.00$ %
Column00% +
<00+ ,
string00, 2
>002 3
(003 4
nullable004 <
:00< =
true00> B
)00B C
}11 
,11 
constraints22 
:22 
table22 "
=>22# %
{33 
table44 
.44 

PrimaryKey44 $
(44$ %
$str44% 5
,445 6
x447 8
=>449 ;
x44< =
.44= >
Id44> @
)44@ A
;44A B
}55 
)55 
;55 
migrationBuilder77 
.77 
CreateTable77 (
(77( )
name88 
:88 
$str88 (
,88( )
columns99 
:99 
table99 
=>99 !
new99" %
{:: 
Id;; 
=;; 
table;; 
.;; 
Column;; %
<;;% &
int;;& )
>;;) *
(;;* +
nullable;;+ 3
:;;3 4
false;;5 :
);;: ;
.<< 

Annotation<< #
(<<# $
$str<<$ C
,<<C D(
MySqlValueGenerationStrategy<<E a
.<<a b
IdentityColumn<<b p
)<<p q
,<<q r
RoleId== 
=== 
table== "
.==" #
Column==# )
<==) *
int==* -
>==- .
(==. /
nullable==/ 7
:==7 8
false==9 >
)==> ?
,==? @
	ClaimType>> 
=>> 
table>>  %
.>>% &
Column>>& ,
<>>, -
string>>- 3
>>>3 4
(>>4 5
nullable>>5 =
:>>= >
true>>? C
)>>C D
,>>D E

ClaimValue?? 
=??  
table??! &
.??& '
Column??' -
<??- .
string??. 4
>??4 5
(??5 6
nullable??6 >
:??> ?
true??@ D
)??D E
}@@ 
,@@ 
constraintsAA 
:AA 
tableAA "
=>AA# %
{BB 
tableCC 
.CC 

PrimaryKeyCC $
(CC$ %
$strCC% :
,CC: ;
xCC< =
=>CC> @
xCCA B
.CCB C
IdCCC E
)CCE F
;CCF G
tableDD 
.DD 

ForeignKeyDD $
(DD$ %
nameEE 
:EE 
$strEE F
,EEF G
columnFF 
:FF 
xFF  !
=>FF" $
xFF% &
.FF& '
RoleIdFF' -
,FF- .
principalTableGG &
:GG& '
$strGG( 5
,GG5 6
principalColumnHH '
:HH' (
$strHH) -
,HH- .
onDeleteII  
:II  !
ReferentialActionII" 3
.II3 4
CascadeII4 ;
)II; <
;II< =
}JJ 
)JJ 
;JJ 
migrationBuilderLL 
.LL 
CreateTableLL (
(LL( )
nameMM 
:MM 
$strMM (
,MM( )
columnsNN 
:NN 
tableNN 
=>NN !
newNN" %
{OO 
IdPP 
=PP 
tablePP 
.PP 
ColumnPP %
<PP% &
intPP& )
>PP) *
(PP* +
nullablePP+ 3
:PP3 4
falsePP5 :
)PP: ;
.QQ 

AnnotationQQ #
(QQ# $
$strQQ$ C
,QQC D(
MySqlValueGenerationStrategyQQE a
.QQa b
IdentityColumnQQb p
)QQp q
,QQq r
UserIdRR 
=RR 
tableRR "
.RR" #
ColumnRR# )
<RR) *
intRR* -
>RR- .
(RR. /
nullableRR/ 7
:RR7 8
falseRR9 >
)RR> ?
,RR? @
	ClaimTypeSS 
=SS 
tableSS  %
.SS% &
ColumnSS& ,
<SS, -
stringSS- 3
>SS3 4
(SS4 5
nullableSS5 =
:SS= >
trueSS? C
)SSC D
,SSD E

ClaimValueTT 
=TT  
tableTT! &
.TT& '
ColumnTT' -
<TT- .
stringTT. 4
>TT4 5
(TT5 6
nullableTT6 >
:TT> ?
trueTT@ D
)TTD E
}UU 
,UU 
constraintsVV 
:VV 
tableVV "
=>VV# %
{WW 
tableXX 
.XX 

PrimaryKeyXX $
(XX$ %
$strXX% :
,XX: ;
xXX< =
=>XX> @
xXXA B
.XXB C
IdXXC E
)XXE F
;XXF G
tableYY 
.YY 

ForeignKeyYY $
(YY$ %
nameZZ 
:ZZ 
$strZZ F
,ZZF G
column[[ 
:[[ 
x[[  !
=>[[" $
x[[% &
.[[& '
UserId[[' -
,[[- .
principalTable\\ &
:\\& '
$str\\( 5
,\\5 6
principalColumn]] '
:]]' (
$str]]) -
,]]- .
onDelete^^  
:^^  !
ReferentialAction^^" 3
.^^3 4
Cascade^^4 ;
)^^; <
;^^< =
}__ 
)__ 
;__ 
migrationBuilderaa 
.aa 
CreateTableaa (
(aa( )
namebb 
:bb 
$strbb (
,bb( )
columnscc 
:cc 
tablecc 
=>cc !
newcc" %
{dd 
LoginProvideree !
=ee" #
tableee$ )
.ee) *
Columnee* 0
<ee0 1
stringee1 7
>ee7 8
(ee8 9
nullableee9 A
:eeA B
falseeeC H
)eeH I
,eeI J
ProviderKeyff 
=ff  !
tableff" '
.ff' (
Columnff( .
<ff. /
stringff/ 5
>ff5 6
(ff6 7
nullableff7 ?
:ff? @
falseffA F
)ffF G
,ffG H
ProviderDisplayNamegg '
=gg( )
tablegg* /
.gg/ 0
Columngg0 6
<gg6 7
stringgg7 =
>gg= >
(gg> ?
nullablegg? G
:ggG H
trueggI M
)ggM N
,ggN O
UserIdhh 
=hh 
tablehh "
.hh" #
Columnhh# )
<hh) *
inthh* -
>hh- .
(hh. /
nullablehh/ 7
:hh7 8
falsehh9 >
)hh> ?
}ii 
,ii 
constraintsjj 
:jj 
tablejj "
=>jj# %
{kk 
tablell 
.ll 

PrimaryKeyll $
(ll$ %
$strll% :
,ll: ;
xll< =
=>ll> @
newllA D
{llE F
xllG H
.llH I
LoginProviderllI V
,llV W
xllX Y
.llY Z
ProviderKeyllZ e
}llf g
)llg h
;llh i
tablemm 
.mm 

ForeignKeymm $
(mm$ %
namenn 
:nn 
$strnn F
,nnF G
columnoo 
:oo 
xoo  !
=>oo" $
xoo% &
.oo& '
UserIdoo' -
,oo- .
principalTablepp &
:pp& '
$strpp( 5
,pp5 6
principalColumnqq '
:qq' (
$strqq) -
,qq- .
onDeleterr  
:rr  !
ReferentialActionrr" 3
.rr3 4
Cascaderr4 ;
)rr; <
;rr< =
}ss 
)ss 
;ss 
migrationBuilderuu 
.uu 
CreateTableuu (
(uu( )
namevv 
:vv 
$strvv '
,vv' (
columnsww 
:ww 
tableww 
=>ww !
newww" %
{xx 
UserIdyy 
=yy 
tableyy "
.yy" #
Columnyy# )
<yy) *
intyy* -
>yy- .
(yy. /
nullableyy/ 7
:yy7 8
falseyy9 >
)yy> ?
,yy? @
RoleIdzz 
=zz 
tablezz "
.zz" #
Columnzz# )
<zz) *
intzz* -
>zz- .
(zz. /
nullablezz/ 7
:zz7 8
falsezz9 >
)zz> ?
}{{ 
,{{ 
constraints|| 
:|| 
table|| "
=>||# %
{}} 
table~~ 
.~~ 

PrimaryKey~~ $
(~~$ %
$str~~% 9
,~~9 :
x~~; <
=>~~= ?
new~~@ C
{~~D E
x~~F G
.~~G H
UserId~~H N
,~~N O
x~~P Q
.~~Q R
RoleId~~R X
}~~Y Z
)~~Z [
;~~[ \
table 
. 

ForeignKey $
($ %
name
ÄÄ 
:
ÄÄ 
$str
ÄÄ E
,
ÄÄE F
column
ÅÅ 
:
ÅÅ 
x
ÅÅ  !
=>
ÅÅ" $
x
ÅÅ% &
.
ÅÅ& '
RoleId
ÅÅ' -
,
ÅÅ- .
principalTable
ÇÇ &
:
ÇÇ& '
$str
ÇÇ( 5
,
ÇÇ5 6
principalColumn
ÉÉ '
:
ÉÉ' (
$str
ÉÉ) -
,
ÉÉ- .
onDelete
ÑÑ  
:
ÑÑ  !
ReferentialAction
ÑÑ" 3
.
ÑÑ3 4
Cascade
ÑÑ4 ;
)
ÑÑ; <
;
ÑÑ< =
table
ÖÖ 
.
ÖÖ 

ForeignKey
ÖÖ $
(
ÖÖ$ %
name
ÜÜ 
:
ÜÜ 
$str
ÜÜ E
,
ÜÜE F
column
áá 
:
áá 
x
áá  !
=>
áá" $
x
áá% &
.
áá& '
UserId
áá' -
,
áá- .
principalTable
àà &
:
àà& '
$str
àà( 5
,
àà5 6
principalColumn
ââ '
:
ââ' (
$str
ââ) -
,
ââ- .
onDelete
ää  
:
ää  !
ReferentialAction
ää" 3
.
ää3 4
Cascade
ää4 ;
)
ää; <
;
ää< =
}
ãã 
)
ãã 
;
ãã 
migrationBuilder
çç 
.
çç 
CreateTable
çç (
(
çç( )
name
éé 
:
éé 
$str
éé (
,
éé( )
columns
èè 
:
èè 
table
èè 
=>
èè !
new
èè" %
{
êê 
UserId
ëë 
=
ëë 
table
ëë "
.
ëë" #
Column
ëë# )
<
ëë) *
int
ëë* -
>
ëë- .
(
ëë. /
nullable
ëë/ 7
:
ëë7 8
false
ëë9 >
)
ëë> ?
,
ëë? @
LoginProvider
íí !
=
íí" #
table
íí$ )
.
íí) *
Column
íí* 0
<
íí0 1
string
íí1 7
>
íí7 8
(
íí8 9
nullable
íí9 A
:
ííA B
false
ííC H
)
ííH I
,
ííI J
Name
ìì 
=
ìì 
table
ìì  
.
ìì  !
Column
ìì! '
<
ìì' (
string
ìì( .
>
ìì. /
(
ìì/ 0
nullable
ìì0 8
:
ìì8 9
false
ìì: ?
)
ìì? @
,
ìì@ A
Value
îî 
=
îî 
table
îî !
.
îî! "
Column
îî" (
<
îî( )
string
îî) /
>
îî/ 0
(
îî0 1
nullable
îî1 9
:
îî9 :
true
îî; ?
)
îî? @
}
ïï 
,
ïï 
constraints
ññ 
:
ññ 
table
ññ "
=>
ññ# %
{
óó 
table
òò 
.
òò 

PrimaryKey
òò $
(
òò$ %
$str
òò% :
,
òò: ;
x
òò< =
=>
òò> @
new
òòA D
{
òòE F
x
òòG H
.
òòH I
UserId
òòI O
,
òòO P
x
òòQ R
.
òòR S
LoginProvider
òòS `
,
òò` a
x
òòb c
.
òòc d
Name
òòd h
}
òòi j
)
òòj k
;
òòk l
table
ôô 
.
ôô 

ForeignKey
ôô $
(
ôô$ %
name
öö 
:
öö 
$str
öö F
,
ööF G
column
õõ 
:
õõ 
x
õõ  !
=>
õõ" $
x
õõ% &
.
õõ& '
UserId
õõ' -
,
õõ- .
principalTable
úú &
:
úú& '
$str
úú( 5
,
úú5 6
principalColumn
ùù '
:
ùù' (
$str
ùù) -
,
ùù- .
onDelete
ûû  
:
ûû  !
ReferentialAction
ûû" 3
.
ûû3 4
Cascade
ûû4 ;
)
ûû; <
;
ûû< =
}
üü 
)
üü 
;
üü 
migrationBuilder
°° 
.
°° 
CreateTable
°° (
(
°°( )
name
¢¢ 
:
¢¢ 
$str
¢¢ (
,
¢¢( )
columns
££ 
:
££ 
table
££ 
=>
££ !
new
££" %
{
§§ 
Id
•• 
=
•• 
table
•• 
.
•• 
Column
•• %
<
••% &
int
••& )
>
••) *
(
••* +
nullable
••+ 3
:
••3 4
false
••5 :
)
••: ;
.
¶¶ 

Annotation
¶¶ #
(
¶¶# $
$str
¶¶$ C
,
¶¶C D*
MySqlValueGenerationStrategy
¶¶E a
.
¶¶a b
IdentityColumn
¶¶b p
)
¶¶p q
,
¶¶q r
SenderId
ßß 
=
ßß 
table
ßß $
.
ßß$ %
Column
ßß% +
<
ßß+ ,
int
ßß, /
>
ßß/ 0
(
ßß0 1
nullable
ßß1 9
:
ßß9 :
false
ßß; @
)
ßß@ A
,
ßßA B

ReceiverId
®® 
=
®®  
table
®®! &
.
®®& '
Column
®®' -
<
®®- .
int
®®. 1
>
®®1 2
(
®®2 3
nullable
®®3 ;
:
®®; <
false
®®= B
)
®®B C
,
®®C D
SendDateTime
©©  
=
©©! "
table
©©# (
.
©©( )
Column
©©) /
<
©©/ 0
DateTime
©©0 8
>
©©8 9
(
©©9 :
nullable
©©: B
:
©©B C
false
©©D I
)
©©I J
,
©©J K
DataType
™™ 
=
™™ 
table
™™ $
.
™™$ %
Column
™™% +
<
™™+ ,
byte
™™, 0
>
™™0 1
(
™™1 2
nullable
™™2 :
:
™™: ;
false
™™< A
)
™™A B
,
™™B C!
EncryptedSessionKey
´´ '
=
´´( )
table
´´* /
.
´´/ 0
Column
´´0 6
<
´´6 7
byte
´´7 ;
[
´´; <
]
´´< =
>
´´= >
(
´´> ?
nullable
´´? G
:
´´G H
true
´´I M
)
´´M N
,
´´N O
Iv
¨¨ 
=
¨¨ 
table
¨¨ 
.
¨¨ 
Column
¨¨ %
<
¨¨% &
byte
¨¨& *
[
¨¨* +
]
¨¨+ ,
>
¨¨, -
(
¨¨- .
nullable
¨¨. 6
:
¨¨6 7
true
¨¨8 <
)
¨¨< =
,
¨¨= >
Hmac
≠≠ 
=
≠≠ 
table
≠≠  
.
≠≠  !
Column
≠≠! '
<
≠≠' (
byte
≠≠( ,
[
≠≠, -
]
≠≠- .
>
≠≠. /
(
≠≠/ 0
nullable
≠≠0 8
:
≠≠8 9
true
≠≠: >
)
≠≠> ?
,
≠≠? @
	Signature
ÆÆ 
=
ÆÆ 
table
ÆÆ  %
.
ÆÆ% &
Column
ÆÆ& ,
<
ÆÆ, -
byte
ÆÆ- 1
[
ÆÆ1 2
]
ÆÆ2 3
>
ÆÆ3 4
(
ÆÆ4 5
nullable
ÆÆ5 =
:
ÆÆ= >
true
ÆÆ? C
)
ÆÆC D
,
ÆÆD E
EncryptedData
ØØ !
=
ØØ" #
table
ØØ$ )
.
ØØ) *
Column
ØØ* 0
<
ØØ0 1
byte
ØØ1 5
[
ØØ5 6
]
ØØ6 7
>
ØØ7 8
(
ØØ8 9
nullable
ØØ9 A
:
ØØA B
true
ØØC G
)
ØØG H
,
ØØH I 
IsMeantForReceiver
∞∞ &
=
∞∞' (
table
∞∞) .
.
∞∞. /
Column
∞∞/ 5
<
∞∞5 6
bool
∞∞6 :
>
∞∞: ;
(
∞∞; <
nullable
∞∞< D
:
∞∞D E
false
∞∞F K
)
∞∞K L
}
±± 
,
±± 
constraints
≤≤ 
:
≤≤ 
table
≤≤ "
=>
≤≤# %
{
≥≥ 
table
¥¥ 
.
¥¥ 

PrimaryKey
¥¥ $
(
¥¥$ %
$str
¥¥% :
,
¥¥: ;
x
¥¥< =
=>
¥¥> @
x
¥¥A B
.
¥¥B C
Id
¥¥C E
)
¥¥E F
;
¥¥F G
table
µµ 
.
µµ 

ForeignKey
µµ $
(
µµ$ %
name
∂∂ 
:
∂∂ 
$str
∂∂ J
,
∂∂J K
column
∑∑ 
:
∑∑ 
x
∑∑  !
=>
∑∑" $
x
∑∑% &
.
∑∑& '

ReceiverId
∑∑' 1
,
∑∑1 2
principalTable
∏∏ &
:
∏∏& '
$str
∏∏( 5
,
∏∏5 6
principalColumn
ππ '
:
ππ' (
$str
ππ) -
,
ππ- .
onDelete
∫∫  
:
∫∫  !
ReferentialAction
∫∫" 3
.
∫∫3 4
Restrict
∫∫4 <
)
∫∫< =
;
∫∫= >
table
ªª 
.
ªª 

ForeignKey
ªª $
(
ªª$ %
name
ºº 
:
ºº 
$str
ºº H
,
ººH I
column
ΩΩ 
:
ΩΩ 
x
ΩΩ  !
=>
ΩΩ" $
x
ΩΩ% &
.
ΩΩ& '
SenderId
ΩΩ' /
,
ΩΩ/ 0
principalTable
ææ &
:
ææ& '
$str
ææ( 5
,
ææ5 6
principalColumn
øø '
:
øø' (
$str
øø) -
,
øø- .
onDelete
¿¿  
:
¿¿  !
ReferentialAction
¿¿" 3
.
¿¿3 4
Restrict
¿¿4 <
)
¿¿< =
;
¿¿= >
}
¡¡ 
)
¡¡ 
;
¡¡ 
migrationBuilder
√√ 
.
√√ 
CreateTable
√√ (
(
√√( )
name
ƒƒ 
:
ƒƒ 
$str
ƒƒ $
,
ƒƒ$ %
columns
≈≈ 
:
≈≈ 
table
≈≈ 
=>
≈≈ !
new
≈≈" %
{
∆∆ 
OwnerId
«« 
=
«« 
table
«« #
.
««# $
Column
««$ *
<
««* +
int
««+ .
>
««. /
(
««/ 0
nullable
««0 8
:
««8 9
false
««: ?
)
««? @
,
««@ A
	ContactId
»» 
=
»» 
table
»»  %
.
»»% &
Column
»»& ,
<
»», -
int
»»- 0
>
»»0 1
(
»»1 2
nullable
»»2 :
:
»»: ;
false
»»< A
)
»»A B
}
…… 
,
…… 
constraints
   
:
   
table
   "
=>
  # %
{
ÀÀ 
table
ÃÃ 
.
ÃÃ 

PrimaryKey
ÃÃ $
(
ÃÃ$ %
$str
ÃÃ% 6
,
ÃÃ6 7
x
ÃÃ8 9
=>
ÃÃ: <
new
ÃÃ= @
{
ÃÃA B
x
ÃÃC D
.
ÃÃD E
OwnerId
ÃÃE L
,
ÃÃL M
x
ÃÃN O
.
ÃÃO P
	ContactId
ÃÃP Y
}
ÃÃZ [
)
ÃÃ[ \
;
ÃÃ\ ]
table
ÕÕ 
.
ÕÕ 

ForeignKey
ÕÕ $
(
ÕÕ$ %
name
ŒŒ 
:
ŒŒ 
$str
ŒŒ E
,
ŒŒE F
column
œœ 
:
œœ 
x
œœ  !
=>
œœ" $
x
œœ% &
.
œœ& '
	ContactId
œœ' 0
,
œœ0 1
principalTable
–– &
:
––& '
$str
––( 5
,
––5 6
principalColumn
—— '
:
——' (
$str
——) -
,
——- .
onDelete
““  
:
““  !
ReferentialAction
““" 3
.
““3 4
Cascade
““4 ;
)
““; <
;
““< =
table
”” 
.
”” 

ForeignKey
”” $
(
””$ %
name
‘‘ 
:
‘‘ 
$str
‘‘ C
,
‘‘C D
column
’’ 
:
’’ 
x
’’  !
=>
’’" $
x
’’% &
.
’’& '
OwnerId
’’' .
,
’’. /
principalTable
÷÷ &
:
÷÷& '
$str
÷÷( 5
,
÷÷5 6
principalColumn
◊◊ '
:
◊◊' (
$str
◊◊) -
,
◊◊- .
onDelete
ÿÿ  
:
ÿÿ  !
ReferentialAction
ÿÿ" 3
.
ÿÿ3 4
Restrict
ÿÿ4 <
)
ÿÿ< =
;
ÿÿ= >
}
ŸŸ 
)
ŸŸ 
;
ŸŸ 
migrationBuilder
€€ 
.
€€ 
CreateIndex
€€ (
(
€€( )
name
‹‹ 
:
‹‹ 
$str
‹‹ 2
,
‹‹2 3
table
›› 
:
›› 
$str
›› )
,
››) *
column
ﬁﬁ 
:
ﬁﬁ 
$str
ﬁﬁ  
)
ﬁﬁ  !
;
ﬁﬁ! "
migrationBuilder
‡‡ 
.
‡‡ 
CreateIndex
‡‡ (
(
‡‡( )
name
·· 
:
·· 
$str
·· %
,
··% &
table
‚‚ 
:
‚‚ 
$str
‚‚ $
,
‚‚$ %
column
„„ 
:
„„ 
$str
„„ (
,
„„( )
unique
‰‰ 
:
‰‰ 
true
‰‰ 
)
‰‰ 
;
‰‰ 
migrationBuilder
ÊÊ 
.
ÊÊ 
CreateIndex
ÊÊ (
(
ÊÊ( )
name
ÁÁ 
:
ÁÁ 
$str
ÁÁ 2
,
ÁÁ2 3
table
ËË 
:
ËË 
$str
ËË )
,
ËË) *
column
ÈÈ 
:
ÈÈ 
$str
ÈÈ  
)
ÈÈ  !
;
ÈÈ! "
migrationBuilder
ÎÎ 
.
ÎÎ 
CreateIndex
ÎÎ (
(
ÎÎ( )
name
ÏÏ 
:
ÏÏ 
$str
ÏÏ 2
,
ÏÏ2 3
table
ÌÌ 
:
ÌÌ 
$str
ÌÌ )
,
ÌÌ) *
column
ÓÓ 
:
ÓÓ 
$str
ÓÓ  
)
ÓÓ  !
;
ÓÓ! "
migrationBuilder
 
.
 
CreateIndex
 (
(
( )
name
ÒÒ 
:
ÒÒ 
$str
ÒÒ 1
,
ÒÒ1 2
table
ÚÚ 
:
ÚÚ 
$str
ÚÚ (
,
ÚÚ( )
column
ÛÛ 
:
ÛÛ 
$str
ÛÛ  
)
ÛÛ  !
;
ÛÛ! "
migrationBuilder
ıı 
.
ıı 
CreateIndex
ıı (
(
ıı( )
name
ˆˆ 
:
ˆˆ 
$str
ˆˆ "
,
ˆˆ" #
table
˜˜ 
:
˜˜ 
$str
˜˜ $
,
˜˜$ %
column
¯¯ 
:
¯¯ 
$str
¯¯ )
)
¯¯) *
;
¯¯* +
migrationBuilder
˙˙ 
.
˙˙ 
CreateIndex
˙˙ (
(
˙˙( )
name
˚˚ 
:
˚˚ 
$str
˚˚ %
,
˚˚% &
table
¸¸ 
:
¸¸ 
$str
¸¸ $
,
¸¸$ %
column
˝˝ 
:
˝˝ 
$str
˝˝ ,
,
˝˝, -
unique
˛˛ 
:
˛˛ 
true
˛˛ 
)
˛˛ 
;
˛˛ 
migrationBuilder
ÄÄ 
.
ÄÄ 
CreateIndex
ÄÄ (
(
ÄÄ( )
name
ÅÅ 
:
ÅÅ 
$str
ÅÅ 6
,
ÅÅ6 7
table
ÇÇ 
:
ÇÇ 
$str
ÇÇ )
,
ÇÇ) *
column
ÉÉ 
:
ÉÉ 
$str
ÉÉ $
)
ÉÉ$ %
;
ÉÉ% &
migrationBuilder
ÖÖ 
.
ÖÖ 
CreateIndex
ÖÖ (
(
ÖÖ( )
name
ÜÜ 
:
ÜÜ 
$str
ÜÜ 4
,
ÜÜ4 5
table
áá 
:
áá 
$str
áá )
,
áá) *
column
àà 
:
àà 
$str
àà "
)
àà" #
;
àà# $
migrationBuilder
ää 
.
ää 
CreateIndex
ää (
(
ää( )
name
ãã 
:
ãã 
$str
ãã 1
,
ãã1 2
table
åå 
:
åå 
$str
åå %
,
åå% &
column
çç 
:
çç 
$str
çç #
)
çç# $
;
çç$ %
}
éé 	
	protected
êê 
override
êê 
void
êê 
Down
êê  $
(
êê$ %
MigrationBuilder
êê% 5
migrationBuilder
êê6 F
)
êêF G
{
ëë 	
migrationBuilder
íí 
.
íí 
	DropTable
íí &
(
íí& '
name
ìì 
:
ìì 
$str
ìì (
)
ìì( )
;
ìì) *
migrationBuilder
ïï 
.
ïï 
	DropTable
ïï &
(
ïï& '
name
ññ 
:
ññ 
$str
ññ (
)
ññ( )
;
ññ) *
migrationBuilder
òò 
.
òò 
	DropTable
òò &
(
òò& '
name
ôô 
:
ôô 
$str
ôô (
)
ôô( )
;
ôô) *
migrationBuilder
õõ 
.
õõ 
	DropTable
õõ &
(
õõ& '
name
úú 
:
úú 
$str
úú '
)
úú' (
;
úú( )
migrationBuilder
ûû 
.
ûû 
	DropTable
ûû &
(
ûû& '
name
üü 
:
üü 
$str
üü (
)
üü( )
;
üü) *
migrationBuilder
°° 
.
°° 
	DropTable
°° &
(
°°& '
name
¢¢ 
:
¢¢ 
$str
¢¢ (
)
¢¢( )
;
¢¢) *
migrationBuilder
§§ 
.
§§ 
	DropTable
§§ &
(
§§& '
name
•• 
:
•• 
$str
•• $
)
••$ %
;
••% &
migrationBuilder
ßß 
.
ßß 
	DropTable
ßß &
(
ßß& '
name
®® 
:
®® 
$str
®® #
)
®®# $
;
®®$ %
migrationBuilder
™™ 
.
™™ 
	DropTable
™™ &
(
™™& '
name
´´ 
:
´´ 
$str
´´ #
)
´´# $
;
´´$ %
}
¨¨ 	
}
≠≠ 
}ÆÆ ê
iC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Models\EncryptedPacket.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Models& ,
{ 
public 

class 
EncryptedPacket  
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
int 
SenderId 
{ 
get !
;! "
set# &
;& '
}( )
public 
User 
Sender 
{ 
get  
;  !
set" %
;% &
}' (
public 
int 

ReceiverId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
User 
Receiver 
{ 
get "
;" #
set$ '
;' (
}) *
public 
DateTime 
SendDateTime $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DataType 
DataType  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
byte 
[ 
] 
EncryptedSessionKey )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public## 
byte## 
[## 
]## 
Iv## 
{## 
get## 
;## 
set##  #
;### $
}##% &
public(( 
byte(( 
[(( 
](( 
Hmac(( 
{(( 
get((  
;((  !
set((" %
;((% &
}((' (
public-- 
byte-- 
[-- 
]-- 
	Signature-- 
{--  !
get--" %
;--% &
set--' *
;--* +
}--, -
public22 
byte22 
[22 
]22 
EncryptedData22 #
{22$ %
get22& )
;22) *
set22+ .
;22. /
}220 1
public77 
bool77 
IsMeantForReceiver77 &
{77' (
get77) ,
;77, -
set77. 1
;771 2
}773 4
=775 6
true777 ;
;77; <
}88 
}99 ‹
hC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Models\Enums\DataType.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Models& ,
{ 
public 

enum 
DataType 
: 
byte 
{ 
Message 
, 
File 
, 
Steganography 
} 
}		 ™
^C:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Models\Role.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Models& ,
{ 
public 

class 
Role 
: 
IdentityRole $
<$ %
int% (
>( )
{ 
public 
const 
string 
RegularUser '
=( )
$str* 7
;7 8
} 
}		 ç

^C:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Models\User.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Models& ,
{ 
public 

class 
User 
: 
IdentityUser $
<$ %
int% (
>( )
{ 
public 
List 
< 
UserContact 
>  
ContactList! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}8 9
public 
string 
PublicKeyXml "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Fullname 
=> !
	FirstName" +
+, -
$str. 1
+2 3
LastName4 <
;< =
}   
}!! æ
eC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Models\UserContact.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Models& ,
{ 
public 

class 
UserContact 
{ 
public 
int 
OwnerId 
{ 
get  
;  !
set" %
;% &
}' (
public 
User 
Owner 
{ 
get 
;  
set! $
;$ %
}& '
public 
int 
	ContactId 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
User		 
Contact		 
{		 
get		 !
;		! "
set		# &
;		& '
}		( )
}

 
} ÎB
yC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\EncryptedPacketRepository.cs
	namespace		 	"
HybridCryptoApp_Server		
  
.		  !
Data		! %
.		% &
Repositories		& 2
{

 
public 

class %
EncryptedPacketRepository *
:+ ,&
IEncryptedPacketRepository- G
{ 
private 
readonly "
HybridCryptoAppContext /
context0 7
;7 8
public %
EncryptedPacketRepository (
(( )"
HybridCryptoAppContext) ?
context@ G
)G H
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
void 
Add 
( 
EncryptedPacket '
newEncryptedPacket( :
): ;
{ 	
if 
( 
context 
. 
EncryptedPackets (
.( )
Find) -
(- .
newEncryptedPacket. @
.@ A
IdA C
)C D
==E G
nullH L
)L M
{ 
context 
. 
EncryptedPackets (
.( )
Add) ,
(, -
newEncryptedPacket- ?
)? @
;@ A
context 
. 
SaveChanges #
(# $
)$ %
;% &
} 
else 
{ 
throw 
new 
ArgumentException +
(+ ,
$", .%
EncryptedPacket with Id: . G
{G H
newEncryptedPacketH Z
.Z [
Id[ ]
}] ^
 already exists!^ n
"n o
)o p
;p q
}   
}!! 	
public$$ 
void$$ 
Update$$ 
($$ 
EncryptedPacket$$ *
existingItem$$+ 7
)$$7 8
{%% 	
if'' 
('' 
context'' 
.'' 
EncryptedPackets'' (
.''( )
Find'') -
(''- .
existingItem''. :
.'': ;
Id''; =
)''= >
!=''? A
null''B F
)''F G
{(( 
context)) 
.)) 
EncryptedPackets)) (
.))( )
Update))) /
())/ 0
existingItem))0 <
)))< =
;))= >
context** 
.** 
SaveChanges** #
(**# $
)**$ %
;**% &
}++ 
else,, 
{-- 
throw.. 
new.. 
ArgumentException.. +
(..+ ,
$".., ..
"No EncryptedPacket found with Id: ... P
{..P Q
existingItem..Q ]
...] ^
Id..^ `
}..` a
!..a b
"..b c
)..c d
;..d e
}// 
}00 	
public33 
void33 
Delete33 
(33 
EncryptedPacket33 *
existingItem33+ 7
)337 8
{44 	
if66 
(66 
context66 
.66 
EncryptedPackets66 (
.66( )
Find66) -
(66- .
existingItem66. :
.66: ;
Id66; =
)66= >
!=66? A
null66B F
)66F G
{77 
context88 
.88 
EncryptedPackets88 (
.88( )
Remove88) /
(88/ 0
existingItem880 <
)88< =
;88= >
context99 
.99 
SaveChanges99 #
(99# $
)99$ %
;99% &
}:: 
else;; 
{<< 
throw== 
new== 
ArgumentException== +
(==+ ,
$"==, ..
"No EncryptedPacket found with Id: ==. P
{==P Q
existingItem==Q ]
.==] ^
Id==^ `
}==` a
!==a b
"==b c
)==c d
;==d e
}>> 
}?? 	
publicBB 
EncryptedPacketBB 
GetByIdBB &
(BB& '
intBB' *
idBB+ -
)BB- .
{CC 	
returnDD 
contextDD 
.DD 
EncryptedPacketsDD +
.DD+ ,
FindDD, 0
(DD0 1
idDD1 3
)DD3 4
;DD4 5
}EE 	
publicHH 
ListHH 
<HH 
EncryptedPacketHH #
>HH# $#
GetAllPacketsOfReceiverHH% <
(HH< =
intHH= @

receiverIdHHA K
)HHK L
{II 	
returnJJ 
contextJJ 
.JJ 
EncryptedPacketsJJ +
.JJ+ ,
WhereJJ, 1
(JJ1 2
eJJ2 3
=>JJ4 6
eJJ7 8
.JJ8 9
IsMeantForReceiverJJ9 K
&&JJL N
eJJO P
.JJP Q

ReceiverIdJJQ [
==JJ\ ^

receiverIdJJ_ i
)JJi j
.JJj k
ToListJJk q
(JJq r
)JJr s
;JJs t
}KK 	
publicNN 
ListNN 
<NN 
EncryptedPacketNN #
>NN# $#
GetAllPacketsOfReceiverNN% <
(NN< =
intNN= @

receiverIdNNA K
,NNK L
DateTimeNNM U
afterNNV [
)NN[ \
{OO 	
returnPP 
contextPP 
.PP 
EncryptedPacketsPP +
.PP+ ,
WherePP, 1
(PP1 2
ePP2 3
=>PP4 6
ePP7 8
.PP8 9
IsMeantForReceiverPP9 K
&&PPL N
ePPO P
.PPP Q

ReceiverIdPPQ [
==PP\ ^

receiverIdPP_ i
&&PPj l
ePPm n
.PPn o
SendDateTimePPo {
>=PP| ~
after	PP Ñ
)
PPÑ Ö
.
PPÖ Ü
ToList
PPÜ å
(
PPå ç
)
PPç é
;
PPé è
}QQ 	
publicTT 
ListTT 
<TT 
EncryptedPacketTT #
>TT# $!
GetAllPacketsOfSenderTT% :
(TT: ;
intTT; >
senderIdTT? G
)TTG H
{UU 	
returnVV 
contextVV 
.VV 
EncryptedPacketsVV +
.VV+ ,
WhereVV, 1
(VV1 2
eVV2 3
=>VV4 6
!VV7 8
eVV8 9
.VV9 :
IsMeantForReceiverVV: L
&&VVM O
eVVP Q
.VVQ R
SenderIdVVR Z
==VV[ ]
senderIdVV^ f
)VVf g
.VVg h
ToListVVh n
(VVn o
)VVo p
;VVp q
}WW 	
publicZZ 
ListZZ 
<ZZ 
EncryptedPacketZZ #
>ZZ# $!
GetAllPacketsOfSenderZZ% :
(ZZ: ;
intZZ; >
senderIdZZ? G
,ZZG H
DateTimeZZI Q
afterZZR W
)ZZW X
{[[ 	
return\\ 
context\\ 
.\\ 
EncryptedPackets\\ +
.\\+ ,
Where\\, 1
(\\1 2
e\\2 3
=>\\4 6
!\\7 8
e\\8 9
.\\9 :
IsMeantForReceiver\\: L
&&\\M O
e\\P Q
.\\Q R
SenderId\\R Z
==\\[ ]
senderId\\^ f
&&\\g i
e\\j k
.\\k l
SendDateTime\\l x
>=\\y {
after	\\| Å
)
\\Å Ç
.
\\Ç É
ToList
\\É â
(
\\â ä
)
\\ä ã
;
\\ã å
}]] 	
publicee 
asyncee 
Taskee 
<ee 
Listee 
<ee 
EncryptedPacketee .
>ee. /
>ee/ 0%
GetAllPacketsBetweenUsersee1 J
(eeJ K
inteeK N
user1IdeeO V
,eeV W
inteeX [
user2Idee\ c
)eec d
{ff 	
returngg 
awaitgg 
contextgg  
.gg  !
EncryptedPacketsgg! 1
.gg1 2
Wheregg2 7
(gg7 8
egg8 9
=>gg: <
egg= >
.gg> ?
SenderIdgg? G
==ggH J
user1IdggK R
&&ggS U
eggV W
.ggW X

ReceiverIdggX b
==ggc e
user2Idggf m
||ggn p
ehhI J
.hhJ K
SenderIdhhK S
==hhT V
user2IdhhW ^
&&hh_ a
ehhb c
.hhc d

ReceiverIdhhd n
==hho q
user1Idhhr y
)hhy z
.ii1 2
ToListAsyncii2 =
(ii= >
)ii> ?
;ii? @
}jj 	
}kk 
}ll œ
zC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\Interfaces\IBaseRepository.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Repositories& 2
.2 3

Interfaces3 =
{ 
public 

	interface 
IBaseRepository $
<$ %
in% '
T( )
>) *
{ 
void 
Add 
( 
T 
newItem 
) 
; 
void 
Update 
( 
T 
existingItem "
)" #
;# $
void		 
Delete		 
(		 
T		 
existingItem		 "
)		" #
;		# $
}

 
} ÿ
ÖC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\Interfaces\IEncryptedPacketRepository.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Repositories& 2
.2 3

Interfaces3 =
{ 
public 

	interface &
IEncryptedPacketRepository /
:0 1
IBaseRepository2 A
<A B
EncryptedPacketB Q
>Q R
{		 
EncryptedPacket 
GetById 
(  
int  #
id$ &
)& '
;' (
List 
< 
EncryptedPacket 
> #
GetAllPacketsOfReceiver 5
(5 6
int6 9

receiverId: D
)D E
;E F
List 
< 
EncryptedPacket 
> !
GetAllPacketsOfSender 3
(3 4
int4 7
senderId8 @
)@ A
;A B
List%% 
<%% 
EncryptedPacket%% 
>%% #
GetAllPacketsOfReceiver%% 5
(%%5 6
int%%6 9

receiverId%%: D
,%%D E
DateTime%%F N
after%%O T
)%%T U
;%%U V
List-- 
<-- 
EncryptedPacket-- 
>-- !
GetAllPacketsOfSender-- 3
(--3 4
int--4 7
senderId--8 @
,--@ A
DateTime--B J
after--K P
)--P Q
;--Q R
Task55 
<55 
List55 
<55 
EncryptedPacket55 !
>55! "
>55" #%
GetAllPacketsBetweenUsers55$ =
(55= >
int55> A
user1Id55B I
,55I J
int55K N
user2Id55O V
)55V W
;55W X
}66 
}77 ◊
ÅC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\Interfaces\IUserContactRepository.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Repositories& 2
.2 3

Interfaces3 =
{ 
public 

	interface "
IUserContactRepository +
:, -
IBaseRepository. =
<= >
UserContact> I
>I J
{ 
List 
< 
UserContact 
> !
GetUserContactsOfUser /
(/ 0
int0 3
ownerId4 ;
); <
;< =
}		 
}

 ˚
zC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\Interfaces\IUserRepository.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Repositories& 2
.2 3

Interfaces3 =
{ 
public 

	interface 
IUserRepository $
:% &
IBaseRepository' 6
<6 7
User7 ;
>; <
{ 
User 
GetById 
( 
int 
userId 
)  
;  !
} 
}		 ˜+
uC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\UserContactRepository.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Repositories& 2
{ 
public		 

class		 !
UserContactRepository		 &
:		' ("
IUserContactRepository		) ?
{

 
private 
readonly "
HybridCryptoAppContext /
context0 7
;7 8
public !
UserContactRepository $
($ %"
HybridCryptoAppContext% ;
context< C
)C D
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
List 
< 
UserContact 
>  !
GetUserContactsOfUser! 6
(6 7
int7 :
ownerId; B
)B C
{ 	
return 
context 
. 
UserContacts '
.' (
Where( -
(- .
u. /
=>0 2
u3 4
.4 5
OwnerId5 <
=== ?
ownerId@ G
)G H
.H I
ToListI O
(O P
)P Q
;Q R
} 	
public 
void 
Add 
( 
UserContact #
newUserContact$ 2
)2 3
{ 	
if 
( 
context 
. 
Users 
. 
Find !
(! "
newUserContact" 0
.0 1
OwnerId1 8
)8 9
!=: <
null= A
&&B D
contextE L
.L M
UsersM R
.R S
FindS W
(W X
newUserContactX f
.f g
	ContactIdg p
)p q
!=r t
nullu y
)y z
{ 
if 
( 
context 
. 
UserContacts (
.( )
Find) -
(- .
newUserContact. <
.< =
OwnerId= D
,D E
newUserContactF T
.T U
	ContactIdU ^
)^ _
==` b
nullc g
)g h
{ 
context   
.   
UserContacts   (
.  ( )
Add  ) ,
(  , -
newUserContact  - ;
)  ; <
;  < =
context!! 
.!! 
SaveChanges!! '
(!!' (
)!!( )
;!!) *
}"" 
else## 
{$$ 
throw%% 
new%% 
ArgumentException%% /
(%%/ 0
$"%%0 2&
Usercontact with ownerId: %%2 L
{%%L M
newUserContact%%M [
.%%[ \
OwnerId%%\ c
}%%c d
 and contactId: %%d t
{%%t u
newUserContact	%%u É
.
%%É Ñ
	ContactId
%%Ñ ç
}
%%ç é
 already exists!
%%é û
"
%%û ü
)
%%ü †
;
%%† °
}&& 
}'' 
else(( 
{)) 
throw** 
new** 
ArgumentException** +
(**+ ,
$"**, .
User with id: **. <
{**< =
newUserContact**= K
.**K L
OwnerId**L S
}**S T
 and/or id: **T `
{**` a
newUserContact**a o
.**o p
	ContactId**p y
}**y z
 does not exist!	**z ä
"
**ä ã
)
**ã å
;
**å ç
}++ 
},, 	
public// 
void// 
Update// 
(// 
UserContact// &
existingItem//' 3
)//3 4
{00 	
throw11 
new11 
ArgumentException11 '
(11' (
$str11( R
)11R S
;11S T
}22 	
public55 
void55 
Delete55 
(55 
UserContact55 &
existingItem55' 3
)553 4
{66 	
UserContact88 
foundContact88 $
=88% &
context88' .
.88. /
UserContacts88/ ;
.88; <
Find88< @
(88@ A
existingItem88A M
.88M N
OwnerId88N U
,88U V
existingItem88W c
.88c d
	ContactId88d m
)88m n
;88n o
if99 
(99 
foundContact99 
!=99 
null99  $
)99$ %
{:: 
foundContact;; 
=;; 
context;; &
.;;& '
Entry;;' ,
(;;, -
foundContact;;- 9
);;9 :
.;;: ;
Entity;;; A
;;;A B
context== 
.== 
UserContacts== $
.==$ %
Remove==% +
(==+ ,
foundContact==, 8
)==8 9
;==9 :
context>> 
.>> 
SaveChanges>> #
(>># $
)>>$ %
;>>% &
}?? 
else@@ 
{AA 
throwBB 
newBB 
ArgumentExceptionBB +
(BB+ ,
$"BB, ./
#No UserContact found with ownerId: BB. Q
{BBQ R
existingItemBBR ^
.BB^ _
OwnerIdBB_ f
}BBf g
 and contactId: BBg w
{BBw x
existingItem	BBx Ñ
.
BBÑ Ö
	ContactId
BBÖ é
}
BBé è
 !
BBè ë
"
BBë í
)
BBí ì
;
BBì î
}CC 
}DD 	
}EE 
}FF Ë 
nC:\Users\Jurgen\source\repos\HybridCryptoApp-Server\HybridCryptoApp-Server.Data\Repositories\UserRepository.cs
	namespace 	"
HybridCryptoApp_Server
  
.  !
Data! %
.% &
Repositories& 2
{ 
public 

class 
UserRepository 
:  !
IUserRepository" 1
{ 
private		 
readonly		 "
HybridCryptoAppContext		 /
context		0 7
;		7 8
public 
UserRepository 
( "
HybridCryptoAppContext 4
context5 <
)< =
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
User 
GetById 
( 
int 
userId  &
)& '
{ 	
return 
context 
. 
Users  
.  !
Find! %
(% &
userId& ,
), -
;- .
} 	
public 
void 
Add 
( 
User 
newUser $
)$ %
{ 	
if 
( 
context 
. 
Users 
. 
Find "
(" #
newUser# *
.* +
Id+ -
)- .
==/ 1
null2 6
)6 7
{ 
context 
. 
Users 
. 
Add !
(! "
newUser" )
)) *
;* +
context 
. 
SaveChanges #
(# $
)$ %
;% &
} 
else 
{   
throw!! 
new!! 
ArgumentException!! +
(!!+ ,
$"!!, .

User with !!. 8
{!!8 9
newUser!!9 @
.!!@ A
Id!!A C
}!!C D
 already exists!!!D T
"!!T U
)!!U V
;!!V W
}"" 
}## 	
public&& 
void&& 
Update&& 
(&& 
User&& 
existingUser&&  ,
)&&, -
{'' 	
if)) 
()) 
context)) 
.)) 
Users)) 
.)) 
Find)) "
())" #
existingUser))# /
.))/ 0
Id))0 2
)))2 3
!=))4 6
null))7 ;
))); <
{** 
context++ 
.++ 
Users++ 
.++ 
Update++ $
(++$ %
existingUser++% 1
)++1 2
;++2 3
context,, 
.,, 
SaveChanges,, #
(,,# $
),,$ %
;,,% &
}-- 
else.. 
{// 
throw00 
new00 
ArgumentException00 +
(00+ ,
$"00, ."
No user found with Id 00. D
{00D E
existingUser00E Q
.00Q R
Id00R T
}00T U
"00U V
)00V W
;00W X
}11 
}22 	
public55 
void55 
Delete55 
(55 
User55 
existingUser55  ,
)55, -
{66 	
if88 
(88 
context88 
.88 
Users88 
.88 
Find88 "
(88" #
existingUser88# /
.88/ 0
Id880 2
)882 3
!=884 6
null887 ;
)88; <
{99 
context:: 
.:: 
Users:: 
.:: 
Remove:: $
(::$ %
existingUser::% 1
)::1 2
;::2 3
context;; 
.;; 
SaveChanges;; #
(;;# $
);;$ %
;;;% &
}<< 
else== 
{>> 
throw?? 
new?? 
ArgumentException?? +
(??+ ,
$"??, ."
No user found with Id ??. D
{??D E
existingUser??E Q
.??Q R
Id??R T
}??T U
"??U V
)??V W
;??W X
}@@ 
}AA 	
}BB 
}CC 